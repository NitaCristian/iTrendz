<div>
    @if (Deliverables is null)
    {
        <MudSkeleton Animation="Animation.Wave" Class="mb-4" Height="40px" Width="150px"/>
        for (var i = 0; i < 3; i++)
        {
            <MudSkeleton Animation="Animation.Wave" Class="mb-1" Height="20px" Width="70px"/>
            <MudSkeleton Width="100%" Height="20px" Animation="Animation.Wave"/>
            <MudSkeleton Animation="Animation.Wave" Height="15px" Width="100%" Class="mb-2"/>
        }
    }
    else
    {
        <MudText Typo="Typo.h6" GutterBottom="true">Deliverables</MudText>
        <MudTabs ApplyEffectsToContainer="true" Elevation="2" PanelClass="pa-6" Rounded="true">
            @foreach (var group in GetGroupedRequirements())
            {
                <MudTabPanel Icon="@GetPlatformIcon(group.Key)" Text="@group.Key.Name">
                    <MudExpansionPanels Class="mt-2" MultiExpansion="true">
                        @foreach (var requirement in group)
                        {
                            <MudExpansionPanel Text="@requirement.ContentType.Name">@requirement.Description</MudExpansionPanel>
                        }
                    </MudExpansionPanels>
                </MudTabPanel>
            }
        </MudTabs>
    }
</div>

@code {
    [Parameter] public ICollection<ContentRequirement>? Deliverables { get; set; }

    public string GetPlatformIcon(Platform platform)
    {
        return platform.Name switch
        {
            "Instagram" => Icons.Custom.Brands.Instagram,
            "Facebook" => Icons.Custom.Brands.Facebook,
            "Twitter" => Icons.Custom.Brands.Twitter,
            "LinkedIn" => Icons.Custom.Brands.LinkedIn,
            "TikTok" => Icons.Custom.Brands.TikTok,
            _ => ""
        };
    }

    public List<IGrouping<Platform, ContentRequirement>> GetGroupedRequirements()
    {
        return Deliverables
            .GroupBy(req => req.Platform)
            .ToList();
    }

}