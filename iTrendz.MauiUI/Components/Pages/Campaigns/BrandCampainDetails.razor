@page "/campaigns/brand/{Id:int}"
@inject ICampaignService CampaignService

<TwoPaneLayout>
    <LeftContent>
        <CampaignHeader ImageUrl="@_campaign?.ImageURL" Title="@_campaign?.Title" Brand="_campaign?.Brand"/>
        <CampaignInfo CampaignDetails="_campaign.CampaignDetails"/>
    </LeftContent>
    <RightContent>
        <MudTabs Elevation="2" Rounded="true" ApplyEffectsToContainer="true" PanelClass="pa-6">
            <MudTabPanel Text="Overview">
                <MudStack>
                    <CampaignDescription Description="@_campaign?.Description"/>
                    <CampaignInfluencerRequirements Requirements="_campaign?.InfluencerRequirements"/>
                    <CampaignPlatforms Platforms="_platforms"/>
                    <CampaignPlatformDeliverables Deliverables="_campaign?.Deliverables"/>
                </MudStack>
            </MudTabPanel>
            <MudTabPanel Text="Influencers">
                <InfluencersDataGrid Influencers="_influencers"/>
            </MudTabPanel>
            <MudTabPanel Text="Insights">
                <CampaignInsights TimelineEvents="_campaign?.TimelineEvents" BudgetStatistics="_campaign.BudgetStatistics" CampaignDetails="_campaign.CampaignDetails" CampaignMetrics="_campaign.CampaignMetrics"/>
            </MudTabPanel>
            <MudTabPanel Text="Posts">
                <CampaignVideos Videos="_videos"/>
            </MudTabPanel>
        </MudTabs>
    </RightContent>
</TwoPaneLayout>

@code {
    [Parameter] public int Id { get; set; }

    private IEnumerable<Influencer>? _influencers;
    private List<Video>? _videos;
    private List<Platform>? _platforms;
    private Campaign? _campaign;

    protected override async Task OnInitializedAsync()
    {
        await Task.Delay(10000);

        _campaign = await CampaignService.GetCampaignAsync(Id);

        _videos =
        [
            new Video
            {
                Id = 1,
                Title = "Car in Forest",
                VideoUrl = "/assets/videos/video.mp4",
                PosterUrl = "/assets/image/poster.jpg"
            },
            new Video()
            {
                Id = 2,
                Title = "Car in Forest",
                VideoUrl = "/assets/videos/video.mp4",
                PosterUrl = "/assets/image/poster.jpg"
            },
            new Video()
            {
                Id = 3,
                Title = "Car in Forest",
                VideoUrl = "/assets/videos/video.mp4",
                PosterUrl = "/assets/image/poster.jpg"
            },
            new Video()
            {
                Id = 4,
                Title = "Car in Forest",
                VideoUrl = "/assets/videos/video.mp4",
                PosterUrl = "/assets/image/poster.jpg"
            }
        ];

        _platforms =
        [
            new Platform { Icon = Icons.Custom.Brands.Instagram, Name = "Instagram" },
            new Platform { Icon = Icons.Custom.Brands.TikTok, Name = "TikTok" },
            new Platform { Icon = Icons.Custom.Brands.YouTube, Name = "YouTube" }
        ];
        
        _influencers = new List<Influencer>
        {
            new()
            {
                UserName = "Sam",
                ImageUrl = "https://picsum.photos/200",
                Status = "Active",
                Price = 250,
                Followers = 87_000
            }
        };
    }

}